javascript:(function(){const u='https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec';function e(k,f=[]){for(const w of k){const r=new RegExp(w,'i');const c=document.querySelectorAll('td, th');for(let i=0;i<c.length;i++){if(r.test(c[i].textContent)){const n=c[i].nextElementSibling;if(n){const t=n.textContent.trim();if(t&&t.length>0)return t}}}const d=document.querySelectorAll('dt');for(const dt of d){if(r.test(dt.textContent)){const dd=dt.nextElementSibling;if(dd&&dd.tagName==='DD'){const t=dd.textContent.trim();if(t&&t.length>0)return t}}}const l=document.querySelectorAll('label, .label, [class*="label"]');for(const lb of l){if(r.test(lb.textContent)){const p=lb.parentElement;const t=p.textContent.replace(lb.textContent,'').trim();if(t&&t.length>0)return t}}}for(const s of f){const el=document.querySelector(s);if(el){const t=el.textContent.trim();if(t&&t.length>0)return t}}return ''}function d(t){if(!t)return '';const m=t.match(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/);if(m){return `${m[1].padStart(2,'0')}/${m[2].padStart(2,'0')}/${m[3]}`}return ''}function b(t){if(!t)return '';const m=t.match(/\$?[\d,]+\.?\d*/);if(m){return m[0].replace(/,/g,'')}return ''}function c(){const ch=[];const r=document.querySelectorAll('tr');r.forEach(row=>{const cells=row.querySelectorAll('td');if(cells.length>=1){const t=cells[0].textContent.trim();if(t.length>10&&(/\d{3,}/.test(t)||/DUI|THEFT|BATTERY|ASSAULT|DRUG|WARRANT/i.test(t))){ch.push(t)}}});const li=document.querySelectorAll('li');li.forEach(l=>{const t=l.textContent.trim();if(t.length>10&&/\d{3,}/.test(t)){ch.push(t)}});if(ch.length===0){const ct=e(['charge','offense','violation'],['[class*="charge"]','[class*="offense"]']);if(ct)ch.push(ct)}return ch.join('; ')}const bn=e(['booking number','booking #','booking id','inmate id'],['[class*="booking"]','.inmate-id']);const fn=e(['name','inmate name'],['h1','h2','[class*="name"]']);const db=d(e(['date of birth','dob'],['[class*="dob"]']));const sx=e(['sex','gender'],['[class*="sex"]']).substring(0,1).toUpperCase();const rc=e(['race'],['[class*="race"]']).substring(0,1).toUpperCase();const ad=d(e(['arrest date'],['[class*="arrest-date"]']));const bd=d(e(['booking date','date booked'],['[class*="booking-date"]']));const ag=e(['agency'],['[class*="agency"]']);const addr=e(['address'],['[class*="address"]']);const ct=e(['city'],['[class*="city"]']);const st=e(['state'],['[class*="state"]'])||'FL';const zp=e(['zip'],['[class*="zip"]']);const ch=c();const ba=b(e(['bond amount','bond'],['[class*="bond"]']));const bt=e(['bond type'],['[class*="bond-type"]']);const sts=e(['status'],['[class*="status"]']);const cd=d(e(['court date'],['[class*="court-date"]']));const cn=e(['case number'],['[class*="case"]']);let f='',l='';if(fn.includes(',')){const p=fn.split(',').map(s=>s.trim());l=p[0];f=p[1]?.split(' ')[0]||''}else{const p=fn.split(' ');f=p[0]||'';l=p[p.length-1]||''}const url=window.location.href.toLowerCase();let co='';if(url.includes('lee'))co='Lee';else if(url.includes('collier'))co='Collier';else if(url.includes('hendry'))co='Hendry';else if(url.includes('charlotte'))co='Charlotte';else if(url.includes('manatee'))co='Manatee';else if(url.includes('sarasota'))co='Sarasota';else if(url.includes('hillsborough')||url.includes('hcso'))co='Hillsborough';const p=new URLSearchParams({bookingNumber:bn,firstName:f,lastName:l,dob:db,sex:sx,race:rc,arrestDate:ad,bookingDate:bd,agency:ag,address:addr,city:ct,state:st,zipcode:zp,charges:ch,bondAmount:ba,bondType:bt,status:sts,courtDate:cd,caseNumber:cn,county:co});for(const [k,v] of Array.from(p.entries())){if(!v||v.trim()===''){p.delete(k)}}window.open(`${u}?${p.toString()}`,'BookingForm','width=900,height=700,scrollbars=yes,resizable=yes')})();
